- test:
    name: {{ plan }}
    timeout:
      minutes: {{ job_timeout }}

    definitions:
    - from: inline
      repository:
        metadata:
          format: Lava-Test Test Definition 1.0
          name: preempt-rt-prereq
          description: Pre-requisites for PREEMPT_RT
        run:
          steps:
          - apt-get update && apt-get install -y procps rt-tests
      name: preempt-rt-prereq
      path: inline/preempt-rt-prereq.yaml

    - repository: https://github.com/kernelci/test-definitions.git
      from: git
      revision: kernelci.org
      path: automated/linux/{{ tst_cmd }}/{{ tst_cmd }}.yaml
      name: {{ plan }}
      parameters:
        AFFINTIY: 0-1
        BACKGROUND_CMD: {{ background|default('hackbench') }}
        DURATION: {{ duration|default('300s') }}
        INTERVAL: 1000
        PRIORITY: 98
        THREADS: 2
